import{r as L,R as C}from"./react-BWH9k979.js";import{R as re}from"./react-dom-BIt8mBlf.js";import{N as et,P as R,a as _,T as P,A as se,S as F,E as oe}from"./prosemirror-state-B7ijfdbY.js";import{E as ie}from"./prosemirror-view-BZyUYLem.js";import{k as ae}from"./prosemirror-keymap-cK5tcrkv.js";import{F as N,S as ce,N as le,a as Ht,D as ct,b as ue}from"./prosemirror-model-m3iZ3_G7.js";import{f as de,c as vt,a as Q,j as Ft,R as pe,b as fe,l as he}from"./prosemirror-transform-OighmD1Q.js";import{w as me,s as Tt,a as ge,b as ye,c as be,d as ve,e as ke,n as Me,l as Se,f as we,j as Ee,g as xe,h as Te,i as Ce,k as Ae,m as Oe,o as Pe,p as Ie,q as $e}from"./prosemirror-commands-8d75fuzH.js";import{w as Le,s as Re,l as Ne}from"./prosemirror-schema-list-7yJCSF5_.js";import{d as Be}from"./prosemirror-dropcursor-JBYQTbem.js";import{g as _e}from"./prosemirror-gapcursor-CVaYHaQC.js";import{h as De,r as je,u as He}from"./prosemirror-history-GfyDCu1z.js";function nt(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}class rt{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:s}=n,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([c,a])=>[c,(...d)=>{const u=a(...d)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,c=[],a=!!t,l=t||o.tr,d=()=>(!a&&n&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),c.every(p=>p===!0)),u={...Object.fromEntries(Object.entries(r).map(([p,f])=>[p,(...m)=>{const g=this.buildProps(l,n),y=f(...m)(g);return c.push(y),u}])),run:d};return u}createCan(t){const{rawCommands:n,state:r}=this,s=!1,o=t||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(n).map(([a,l])=>[a,(...d)=>l(...d)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,c={tr:t,editor:s,view:i,state:nt({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([a,l])=>[a,(...d)=>l(...d)(c)]))}};return c}}class Fe{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(s=>s.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(s=>s!==n):delete this.callbacks[t]),this}once(t,n){const r=(...s)=>{this.off(t,r),n.apply(this,s)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}}function b(e,t,n){return e.config[t]===void 0&&e.parent?b(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?b(e.parent,t,n):null}):e.config[t]}function st(e){const t=e.filter(s=>s.type==="extension"),n=e.filter(s=>s.type==="node"),r=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function zt(e){const t=[],{nodeExtensions:n,markExtensions:r}=st(e),s=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const c={name:i.name,options:i.options,storage:i.storage,extensions:s},a=b(i,"addGlobalAttributes",c);if(!a)return;a().forEach(d=>{d.types.forEach(u=>{Object.entries(d.attributes).forEach(([p,f])=>{t.push({type:u,name:p,attribute:{...o,...f}})})})})}),s.forEach(i=>{const c={name:i.name,options:i.options,storage:i.storage},a=b(i,"addAttributes",c);if(!a)return;const l=a();Object.entries(l).forEach(([d,u])=>{const p={...o,...u};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:i.name,name:d,attribute:p})})}),t}function x(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function A(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const c=o?o.split(" "):[],a=r[s]?r[s].split(" "):[],l=c.filter(d=>!a.includes(d));r[s]=[...a,...l].join(" ")}else if(s==="style"){const c=o?o.split(";").map(d=>d.trim()).filter(Boolean):[],a=r[s]?r[s].split(";").map(d=>d.trim()).filter(Boolean):[],l=new Map;a.forEach(d=>{const[u,p]=d.split(":").map(f=>f.trim());l.set(u,p)}),c.forEach(d=>{const[u,p]=d.split(":").map(f=>f.trim());l.set(u,p)}),r[s]=Array.from(l.entries()).map(([d,u])=>`${d}: ${u}`).join("; ")}else r[s]=o}),r},{})}function ht(e,t){return t.filter(n=>n.type===e.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>A(n,r),{})}function Vt(e){return typeof e=="function"}function k(e,t=void 0,...n){return Vt(e)?t?e.bind(t)(...n):e(...n):e}function ze(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Ve(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Ct(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const s=t.reduce((o,i)=>{const c=i.attribute.parseHTML?i.attribute.parseHTML(n):Ve(n.getAttribute(i.name));return c==null?o:{...o,[i.name]:c}},{});return{...r,...s}}}}function At(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&ze(n)?!1:n!=null))}function We(e,t){var n;const r=zt(e),{nodeExtensions:s,markExtensions:o}=st(e),i=(n=s.find(l=>b(l,"topNode")))===null||n===void 0?void 0:n.name,c=Object.fromEntries(s.map(l=>{const d=r.filter(y=>y.type===l.name),u={name:l.name,options:l.options,storage:l.storage,editor:t},p=e.reduce((y,v)=>{const M=b(v,"extendNodeSchema",u);return{...y,...M?M(l):{}}},{}),f=At({...p,content:k(b(l,"content",u)),marks:k(b(l,"marks",u)),group:k(b(l,"group",u)),inline:k(b(l,"inline",u)),atom:k(b(l,"atom",u)),selectable:k(b(l,"selectable",u)),draggable:k(b(l,"draggable",u)),code:k(b(l,"code",u)),whitespace:k(b(l,"whitespace",u)),linebreakReplacement:k(b(l,"linebreakReplacement",u)),defining:k(b(l,"defining",u)),isolating:k(b(l,"isolating",u)),attrs:Object.fromEntries(d.map(y=>{var v;return[y.name,{default:(v=y==null?void 0:y.attribute)===null||v===void 0?void 0:v.default}]}))}),h=k(b(l,"parseHTML",u));h&&(f.parseDOM=h.map(y=>Ct(y,d)));const m=b(l,"renderHTML",u);m&&(f.toDOM=y=>m({node:y,HTMLAttributes:ht(y,d)}));const g=b(l,"renderText",u);return g&&(f.toText=g),[l.name,f]})),a=Object.fromEntries(o.map(l=>{const d=r.filter(g=>g.type===l.name),u={name:l.name,options:l.options,storage:l.storage,editor:t},p=e.reduce((g,y)=>{const v=b(y,"extendMarkSchema",u);return{...g,...v?v(l):{}}},{}),f=At({...p,inclusive:k(b(l,"inclusive",u)),excludes:k(b(l,"excludes",u)),group:k(b(l,"group",u)),spanning:k(b(l,"spanning",u)),code:k(b(l,"code",u)),attrs:Object.fromEntries(d.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),h=k(b(l,"parseHTML",u));h&&(f.parseDOM=h.map(g=>Ct(g,d)));const m=b(l,"renderHTML",u);return m&&(f.toDOM=g=>m({mark:g,HTMLAttributes:ht(g,d)})),[l.name,f]}));return new Ht({topNode:i,nodes:c,marks:a})}function lt(e,t){return t.nodes[e]||t.marks[e]||null}function Ot(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}function kt(e,t){const n=ue.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}const qe=(e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(s,o,i,c)=>{var a,l;const d=((l=(a=s.type.spec).toText)===null||l===void 0?void 0:l.call(a,{node:s,pos:o,parent:i,index:c}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?d:d.slice(0,Math.max(0,r-o))}),n};function Mt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class ot{constructor(t){this.find=t.find,this.handler=t.handler}}const Ke=(e,t)=>{if(Mt(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function U(e){var t;const{editor:n,from:r,to:s,text:o,rules:i,plugin:c}=e,{view:a}=n;if(a.composing)return!1;const l=a.state.doc.resolve(r);if(l.parent.type.spec.code||!((t=l.nodeBefore||l.nodeAfter)===null||t===void 0)&&t.marks.find(p=>p.type.spec.code))return!1;let d=!1;const u=qe(l)+o;return i.forEach(p=>{if(d)return;const f=Ke(u,p.find);if(!f)return;const h=a.state.tr,m=nt({state:a.state,transaction:h}),g={from:r-(f[0].length-o.length),to:s},{commands:y,chain:v,can:M}=new rt({editor:n,state:m});p.handler({state:m,range:g,match:f,commands:y,chain:v,can:M})===null||!h.steps.length||(h.setMeta(c,{transform:h,from:r,to:s,text:o}),a.dispatch(h),d=!0)}),d}function Ue(e){const{editor:t,rules:n}=e,r=new R({state:{init(){return null},apply(s,o,i){const c=s.getMeta(r);if(c)return c;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:d}=a;typeof d=="string"?d=d:d=kt(N.from(d),i.schema);const{from:u}=a,p=u+d.length;U({editor:t,from:u,to:p,text:d,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,c){return U({editor:t,from:o,to:i,text:c,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&U({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?U({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function Ge(e){return Object.prototype.toString.call(e).slice(8,-1)}function G(e){return Ge(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function it(e,t){const n={...e};return G(e)&&G(t)&&Object.keys(t).forEach(r=>{G(t[r])&&G(e[r])?n[r]=it(e[r],t[r]):n[r]=t[r]}),n}class B{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(b(this,"addOptions",{name:this.name}))),this.storage=k(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new B(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>it(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new B(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(b(n,"addOptions",{name:n.name})),n.storage=k(b(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(l=>(l==null?void 0:l.type.name)===n.name))return!1;const a=i.find(l=>(l==null?void 0:l.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}}function Je(e){return typeof e=="number"}class Ye{constructor(t){this.find=t.find,this.handler=t.handler}}const Qe=(e,t,n)=>{if(Mt(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function Xe(e){const{editor:t,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:c}=e,{commands:a,chain:l,can:d}=new rt({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,s,(f,h)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(r,h),g=Math.min(s,h+f.content.size),y=f.textBetween(m-h,g-h,void 0,"￼");Qe(y,o.find,i).forEach(M=>{if(M.index===void 0)return;const E=m+M.index+1,S=E+M[0].length,w={from:n.tr.mapping.map(E),to:n.tr.mapping.map(S)},T=o.handler({state:n,range:w,match:M,commands:a,chain:l,can:d,pasteEvent:i,dropEvent:c});u.push(T)})}),u.every(f=>f!==null)}let J=null;const Ze=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n};function tn(e){const{editor:t,rules:n}=e;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,c;try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}const a=({state:d,from:u,to:p,rule:f,pasteEvt:h})=>{const m=d.tr,g=nt({state:d,transaction:m});if(!(!Xe({editor:t,state:g,from:Math.max(u-1,0),to:p.b-1,rule:f,pasteEvent:h,dropEvent:c})||!m.steps.length)){try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return n.map(d=>new R({view(u){const p=h=>{var m;r=!((m=u.dom.parentElement)===null||m===void 0)&&m.contains(h.target)?u.dom.parentElement:null,r&&(J=t)},f=()=>{J&&(J=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(u,p)=>{if(o=r===u.dom.parentElement,c=p,!o){const f=J;f&&setTimeout(()=>{const h=f.state.selection;h&&f.commands.deleteRange({from:h.from,to:h.to})},10)}return!1},paste:(u,p)=>{var f;const h=(f=p.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return i=p,s=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(u,p,f)=>{const h=u[0],m=h.getMeta("uiEvent")==="paste"&&!s,g=h.getMeta("uiEvent")==="drop"&&!o,y=h.getMeta("applyPasteRules"),v=!!y;if(!m&&!g&&!v)return;if(v){let{text:S}=y;typeof S=="string"?S=S:S=kt(N.from(S),f.schema);const{from:w}=y,T=w+S.length,$=Ze(S);return a({rule:d,state:f,from:w,to:{b:T},pasteEvt:$})}const M=p.doc.content.findDiffStart(f.doc.content),E=p.doc.content.findDiffEnd(f.doc.content);if(!(!Je(M)||!E||M===E.b))return a({rule:d,state:f,from:M,to:E,pasteEvt:i})}}))}function en(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return Array.from(new Set(t))}class z{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=z.resolve(t),this.schema=We(this.extensions,n),this.setupExtensions()}static resolve(t){const n=z.sort(z.flatten(t)),r=en(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=b(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(t){return t.sort((r,s)=>{const o=b(r,"priority")||100,i=b(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:lt(n.name,this.schema)},s=b(n,"addCommands",r);return s?{...t,...s()}:t},{})}get plugins(){const{editor:t}=this,n=z.sort([...this.extensions].reverse()),r=[],s=[],o=n.map(i=>{const c={name:i.name,options:i.options,storage:i.storage,editor:t,type:lt(i.name,this.schema)},a=[],l=b(i,"addKeyboardShortcuts",c);let d={};if(i.type==="mark"&&b(i,"exitable",c)&&(d.ArrowRight=()=>B.handleExit({editor:t,mark:i})),l){const m=Object.fromEntries(Object.entries(l()).map(([g,y])=>[g,()=>y({editor:t})]));d={...d,...m}}const u=ae(d);a.push(u);const p=b(i,"addInputRules",c);Ot(i,t.options.enableInputRules)&&p&&r.push(...p());const f=b(i,"addPasteRules",c);Ot(i,t.options.enablePasteRules)&&f&&s.push(...f());const h=b(i,"addProseMirrorPlugins",c);if(h){const m=h();a.push(...m)}return a}).flat();return[Ue({editor:t,rules:r}),...tn({editor:t,rules:s}),...o]}get attributes(){return zt(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=st(this.extensions);return Object.fromEntries(n.filter(r=>!!b(r,"addNodeView")).map(r=>{const s=this.attributes.filter(a=>a.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:x(r.name,this.schema)},i=b(r,"addNodeView",o);if(!i)return[];const c=(a,l,d,u,p)=>{const f=ht(a,s);return i()({node:a,view:l,getPos:d,decorations:u,innerDecorations:p,editor:t,extension:r,HTMLAttributes:f})};return[r.name,c]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:lt(t.name,this.schema)};t.type==="mark"&&(!((n=k(b(t,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(t.name);const s=b(t,"onBeforeCreate",r),o=b(t,"onCreate",r),i=b(t,"onUpdate",r),c=b(t,"onSelectionUpdate",r),a=b(t,"onTransaction",r),l=b(t,"onFocus",r),d=b(t,"onBlur",r),u=b(t,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),c&&this.editor.on("selectionUpdate",c),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),d&&this.editor.on("blur",d),u&&this.editor.on("destroy",u)})}}class O{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(b(this,"addOptions",{name:this.name}))),this.storage=k(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new O(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>it(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new O({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(b(n,"addOptions",{name:n.name})),n.storage=k(b(n,"addStorage",{name:n.name,options:n.options})),n}}function Wt(e,t,n){const{from:r,to:s}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let c="";return e.nodesBetween(r,s,(a,l,d,u)=>{var p;a.isBlock&&l>r&&(c+=o);const f=i==null?void 0:i[a.type.name];if(f)return d&&(c+=f({node:a,pos:l,parent:d,index:u,range:t})),!1;a.isText&&(c+=(p=a==null?void 0:a.text)===null||p===void 0?void 0:p.slice(Math.max(r,l)-l,s-l))}),c}function qt(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const nn=O.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new R({key:new _("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:o}=s,i=Math.min(...o.map(d=>d.$from.pos)),c=Math.max(...o.map(d=>d.$to.pos)),a=qt(n);return Wt(r,{from:i,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),rn=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),sn=(e=!1)=>({commands:t})=>t.setContent("",e),on=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(c,a)=>{if(c.type.isText)return;const{doc:l,mapping:d}=t,u=l.resolve(d.map(a)),p=l.resolve(d.map(a+c.nodeSize)),f=u.blockRange(p);if(!f)return;const h=he(f);if(c.type.isTextblock){const{defaultType:m}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(f.start,m)}(h||h===0)&&t.lift(f,h)})}),!0},an=e=>t=>e(t),cn=()=>({state:e,dispatch:t})=>$e(e,t),ln=(e,t)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const i=r.mapping.map(t);return r.insert(i,o.content),r.setSelection(new P(r.doc.resolve(i-1))),!0},un=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(t){const c=s.before(o),a=s.after(o);e.delete(c,a).scrollIntoView()}return!0}return!1},dn=e=>({tr:t,state:n,dispatch:r})=>{const s=x(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const a=o.before(i),l=o.after(i);t.delete(a,l).scrollIntoView()}return!0}return!1},pn=e=>({tr:t,dispatch:n})=>{const{from:r,to:s}=e;return n&&t.delete(r,s),!0},fn=()=>({state:e,dispatch:t})=>Ie(e,t),hn=()=>({commands:e})=>e.keyboardShortcut("Enter"),mn=()=>({state:e,dispatch:t})=>Pe(e,t);function Z(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>n.strict?t[s]===e[s]:Mt(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function Kt(e,t,n={}){return e.find(r=>r.type===t&&Z(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function Pt(e,t,n={}){return!!Kt(e,t,n)}function St(e,t,n){var r;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(d=>d.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(d=>d.type===t)||(n=n||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!Kt([...s.node.marks],t,n)))return;let i=s.index,c=e.start()+s.offset,a=i+1,l=c+s.node.nodeSize;for(;i>0&&Pt([...e.parent.child(i-1).marks],t,n);)i-=1,c-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&Pt([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:c,to:l}}function D(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const gn=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const o=D(e,r.schema),{doc:i,selection:c}=n,{$from:a,from:l,to:d}=c;if(s){const u=St(a,o,t);if(u&&u.from<=l&&u.to>=d){const p=P.create(i,u.from,u.to);n.setSelection(p)}}return!0},yn=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function Ut(e){return e instanceof P}function H(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Gt(e,t=null){if(!t)return null;const n=F.atStart(e),r=F.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const s=n.from,o=r.to;return t==="all"?P.create(e,H(0,s,o),H(e.content.size,s,o)):P.create(e,H(t,s,o),H(t,s,o))}const bn=(e=null,t={})=>({editor:n,view:r,tr:s,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=()=>{r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!Ut(n.state.selection))return i(),!0;const c=Gt(s.doc,e)||n.state.selection,a=n.state.selection.eq(c);return o&&(a||s.setSelection(c),a&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},vn=(e,t)=>n=>e.every((r,s)=>t(r,{...n,index:s})),kn=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),Jt=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&Jt(r)}return e};function Y(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return Jt(n)}function tt(e,t,n){if(e instanceof le||e instanceof N)return e;n={slice:!0,parseOptions:{},...n};const r=typeof e=="object"&&e!==null,s=typeof e=="string";if(r)try{if(Array.isArray(e)&&e.length>0)return N.fromArray(e.map(c=>t.nodeFromJSON(c)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),tt("",t,n)}if(s){if(n.errorOnInvalidContent){let i=!1,c="";const a=new Ht({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:l=>(i=!0,c=typeof l=="string"?l:l.outerHTML,null)}]}})});if(n.slice?ct.fromSchema(a).parseSlice(Y(e),n.parseOptions):ct.fromSchema(a).parse(Y(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const o=ct.fromSchema(t);return n.slice?o.parseSlice(Y(e),n.parseOptions).content:o.parse(Y(e),n.parseOptions)}return tt("",t,n)}function Mn(e,t,n){const r=e.steps.length-1;if(r<t)return;const s=e.steps[r];if(!(s instanceof pe||s instanceof fe))return;const o=e.mapping.maps[r];let i=0;o.forEach((c,a,l,d)=>{i===0&&(i=d)}),e.setSelection(F.near(e.doc.resolve(i),n))}const Sn=e=>!("type"in e),wn=(e,t,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;try{c=tt(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(h){return o.emit("contentError",{editor:o,error:h,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:a,to:l}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},d=!0,u=!0;if((Sn(c)?c:[c]).forEach(h=>{h.check(),d=d?h.isText&&h.marks.length===0:!1,u=u?h.isBlock:!1}),a===l&&u){const{parent:h}=r.doc.resolve(a);h.isTextblock&&!h.type.spec.code&&!h.childCount&&(a-=1,l+=1)}let f;if(d){if(Array.isArray(t))f=t.map(h=>h.text||"").join("");else if(t instanceof N){let h="";t.forEach(m=>{m.text&&(h+=m.text)}),f=h}else typeof t=="object"&&t&&t.text?f=t.text:f=t;r.insertText(f,a,l)}else f=c,r.replaceWith(a,l,f);n.updateSelection&&Mn(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:a,text:f}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:a,text:f})}return!0},En=()=>({state:e,dispatch:t})=>Ee(e,t),xn=()=>({state:e,dispatch:t})=>Ae(e,t),Tn=()=>({state:e,dispatch:t})=>Oe(e,t),Cn=()=>({state:e,dispatch:t})=>Ce(e,t),An=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Ft(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},On=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Ft(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},Pn=()=>({state:e,dispatch:t})=>Te(e,t),In=()=>({state:e,dispatch:t})=>xe(e,t);function Yt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function Qt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function $n(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let c=0;c<t.length-1;c+=1){const a=t[c];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))s=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Yt()||Qt()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const Ln=e=>({editor:t,view:n,tr:r,dispatch:s})=>{const o=$n(e).split(/-(?!$)/),i=o.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),c=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),a=t.captureTransaction(()=>{n.someProp("handleKeyDown",l=>l(n,c))});return a==null||a.steps.forEach(l=>{const d=l.map(r.mapping);d&&s&&r.maybeStep(d)}),!0};function q(e,t,n={}){const{from:r,to:s,empty:o}=e.selection,i=t?x(t,e.schema):null,c=[];e.doc.nodesBetween(r,s,(u,p)=>{if(u.isText)return;const f=Math.max(r,p),h=Math.min(s,p+u.nodeSize);c.push({node:u,from:f,to:h})});const a=s-r,l=c.filter(u=>i?i.name===u.node.type.name:!0).filter(u=>Z(u.node.attrs,n,{strict:!1}));return o?!!l.length:l.reduce((u,p)=>u+p.to-p.from,0)>=a}const Rn=(e,t={})=>({state:n,dispatch:r})=>{const s=x(e,n.schema);return q(n,s,t)?we(n,r):!1},Nn=()=>({state:e,dispatch:t})=>Se(e,t),Bn=e=>({state:t,dispatch:n})=>{const r=x(e,t.schema);return Ne(r)(t,n)},_n=()=>({state:e,dispatch:t})=>Me(e,t);function at(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function It(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,s)=>(n.includes(s)||(r[s]=e[s]),r),{})}const Dn=(e,t)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const c=at(typeof e=="string"?e:e.name,r.schema);return c?(c==="node"&&(o=x(e,r.schema)),c==="mark"&&(i=D(e,r.schema)),s&&n.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(l,d)=>{o&&o===l.type&&n.setNodeMarkup(d,void 0,It(l.attrs,t)),i&&l.marks.length&&l.marks.forEach(u=>{i===u.type&&n.addMark(d,d+l.nodeSize,i.create(It(u.attrs,t)))})})}),!0):!1},jn=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Hn=()=>({tr:e,dispatch:t})=>{if(t){const n=new se(e.doc);e.setSelection(n)}return!0},Fn=()=>({state:e,dispatch:t})=>ke(e,t),zn=()=>({state:e,dispatch:t})=>ve(e,t),Vn=()=>({state:e,dispatch:t})=>be(e,t),Wn=()=>({state:e,dispatch:t})=>ye(e,t),qn=()=>({state:e,dispatch:t})=>ge(e,t);function mt(e,t,n={},r={}){return tt(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const Kn=(e,t=!1,n={},r={})=>({editor:s,tr:o,dispatch:i,commands:c})=>{var a,l;const{doc:d}=o;if(n.preserveWhitespace!=="full"){const u=mt(e,s.schema,n,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:s.options.enableContentCheck});return i&&o.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!t),!0}return i&&o.setMeta("preventUpdate",!t),c.insertContentAt({from:0,to:d.content.size},e,{parseOptions:n,errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck})};function Xt(e,t){const n=D(t,e.schema),{from:r,to:s,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,a=>{i.push(...a.marks)});const c=i.find(a=>a.type.name===n.name);return c?{...c.attrs}:{}}function Un(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Gn(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function wt(e){return t=>Gn(t.$from,e)}function Jn(e,t){const n={from:0,to:e.content.size};return Wt(e,n,t)}function Yn(e,t){const n=x(t,e.schema),{from:r,to:s}=e.selection,o=[];e.doc.nodesBetween(r,s,c=>{o.push(c)});const i=o.reverse().find(c=>c.type.name===n.name);return i?{...i.attrs}:{}}function Qn(e,t){const n=at(typeof t=="string"?t:t.name,e.schema);return n==="node"?Yn(e,t):n==="mark"?Xt(e,t):{}}function Zt(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(s=>{const o=n.resolve(e),i=St(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(e,t,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}function X(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=e.find(o=>o.type===t&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}function gt(e,t,n={}){const{empty:r,ranges:s}=e.selection,o=t?D(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>Z(u.attrs,n,{strict:!1}));let i=0;const c=[];if(s.forEach(({$from:u,$to:p})=>{const f=u.pos,h=p.pos;e.doc.nodesBetween(f,h,(m,g)=>{if(!m.isText&&!m.marks.length)return;const y=Math.max(f,g),v=Math.min(h,g+m.nodeSize),M=v-y;i+=M,c.push(...m.marks.map(E=>({mark:E,from:y,to:v})))})}),i===0)return!1;const a=c.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>Z(u.mark.attrs,n,{strict:!1})).reduce((u,p)=>u+p.to-p.from,0),l=c.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,p)=>u+p.to-p.from,0);return(a>0?a+l:a)>=i}function Xn(e,t,n={}){if(!t)return q(e,null,n)||gt(e,null,n);const r=at(t,e.schema);return r==="node"?q(e,t,n):r==="mark"?gt(e,t,n):!1}function $t(e,t){const{nodeExtensions:n}=st(t),r=n.find(i=>i.name===e);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=k(b(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function Et(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((r=e.text)!==null&&r!==void 0?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(o=>{s!==!1&&(Et(o,{ignoreWhitespace:n,checkChildren:t})||(s=!1))}),s}return!1}function Zn(e){return e instanceof et}function tr(e,t,n){var r;const{selection:s}=t;let o=null;if(Ut(s)&&(o=s.$cursor),o){const c=(r=e.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(c)||!c.some(a=>a.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:c,$to:a})=>{let l=c.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(c.pos,a.pos,(d,u,p)=>{if(l)return!1;if(d.isInline){const f=!p||p.type.allowsMarkType(n),h=!!n.isInSet(d.marks)||!d.marks.some(m=>m.type.excludes(n));l=f&&h}return!l}),l})}const er=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:c}=o,a=D(e,r.schema);if(s)if(i){const l=Xt(r,a);n.addStoredMark(a.create({...l,...t}))}else c.forEach(l=>{const d=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(d,u,(p,f)=>{const h=Math.max(f,d),m=Math.min(f+p.nodeSize,u);p.marks.find(y=>y.type===a)?p.marks.forEach(y=>{a===y.type&&n.addMark(h,m,a.create({...y.attrs,...t}))}):n.addMark(h,m,a.create(t))})});return tr(r,n,a)},nr=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),rr=(e,t={})=>({state:n,dispatch:r,chain:s})=>{const o=x(e,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:c})=>Tt(o,{...i,...t})(n)?!0:c.clearNodes()).command(({state:c})=>Tt(o,{...i,...t})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},sr=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,s=H(e,0,r.content.size),o=et.create(r,s);t.setSelection(o)}return!0},or=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,i=P.atStart(r).from,c=P.atEnd(r).to,a=H(s,i,c),l=H(o,i,c),d=P.create(r,a,l);t.setSelection(d)}return!0},ir=e=>({state:t,dispatch:n})=>{const r=x(e,t.schema);return Re(r)(t,n)};function Lt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(r)}}const ar=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=t,{$from:c,$to:a}=o,l=s.extensionManager.attributes,d=X(l,c.node().type.name,c.node().attrs);if(o instanceof et&&o.node.isBlock)return!c.parentOffset||!Q(i,c.pos)?!1:(r&&(e&&Lt(n,s.extensionManager.splittableMarks),t.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const u=a.parentOffset===a.parent.content.size,p=c.depth===0?void 0:Un(c.node(-1).contentMatchAt(c.indexAfter(-1)));let f=u&&p?[{type:p,attrs:d}]:void 0,h=Q(t.doc,t.mapping.map(c.pos),1,f);if(!f&&!h&&Q(t.doc,t.mapping.map(c.pos),1,p?[{type:p}]:void 0)&&(h=!0,f=p?[{type:p,attrs:d}]:void 0),r){if(h&&(o instanceof P&&t.deleteSelection(),t.split(t.mapping.map(c.pos),1,f),p&&!u&&!c.parentOffset&&c.parent.type!==p)){const m=t.mapping.map(c.before()),g=t.doc.resolve(m);c.node(-1).canReplaceWith(g.index(),g.index()+1,p)&&t.setNodeMarkup(t.mapping.map(c.before()),p)}e&&Lt(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return h},cr=(e,t={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const c=x(e,r.schema),{$from:a,$to:l}=r.selection,d=r.selection.node;if(d&&d.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==c)return!1;const p=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==c||a.index(-2)!==a.node(-2).childCount-1)return!1;if(s){let y=N.empty;const v=a.index(-1)?1:a.index(-2)?2:3;for(let $=a.depth-v;$>=a.depth-3;$-=1)y=N.from(a.node($).copy(y));const M=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,E={...X(p,a.node().type.name,a.node().attrs),...t},S=((i=c.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(E))||void 0;y=y.append(N.from(c.createAndFill(null,S)||void 0));const w=a.before(a.depth-(v-1));n.replace(w,a.after(-M),new ce(y,4-v,0));let T=-1;n.doc.nodesBetween(w,n.doc.content.size,($,ne)=>{if(T>-1)return!1;$.isTextblock&&$.content.size===0&&(T=ne+1)}),T>-1&&n.setSelection(P.near(n.doc.resolve(T))),n.scrollIntoView()}return!0}const f=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,h={...X(p,u.type.name,u.attrs),...t},m={...X(p,a.node().type.name,a.node().attrs),...t};n.delete(a.pos,l.pos);const g=f?[{type:c,attrs:h},{type:f,attrs:m}]:[{type:c,attrs:h}];if(!Q(n.doc,a.pos,2))return!1;if(s){const{selection:y,storedMarks:v}=r,{splittableMarks:M}=o.extensionManager,E=v||y.$to.parentOffset&&y.$from.marks();if(n.split(a.pos,2,g).scrollIntoView(),!E||!s)return!0;const S=E.filter(w=>M.includes(w.type.name));n.ensureMarks(S)}return!0},ut=(e,t)=>{const n=wt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&vt(e.doc,n.pos)&&e.join(n.pos),!0},dt=(e,t)=>{const n=wt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&vt(e.doc,r)&&e.join(r),!0},lr=(e,t,n,r={})=>({editor:s,tr:o,state:i,dispatch:c,chain:a,commands:l,can:d})=>{const{extensions:u,splittableMarks:p}=s.extensionManager,f=x(e,i.schema),h=x(t,i.schema),{selection:m,storedMarks:g}=i,{$from:y,$to:v}=m,M=y.blockRange(v),E=g||m.$to.parentOffset&&m.$from.marks();if(!M)return!1;const S=wt(w=>$t(w.type.name,u))(m);if(M.depth>=1&&S&&M.depth-S.depth<=1){if(S.node.type===f)return l.liftListItem(h);if($t(S.node.type.name,u)&&f.validContent(S.node.content)&&c)return a().command(()=>(o.setNodeMarkup(S.pos,f),!0)).command(()=>ut(o,f)).command(()=>dt(o,f)).run()}return!n||!E||!c?a().command(()=>d().wrapInList(f,r)?!0:l.clearNodes()).wrapInList(f,r).command(()=>ut(o,f)).command(()=>dt(o,f)).run():a().command(()=>{const w=d().wrapInList(f,r),T=E.filter($=>p.includes($.type.name));return o.ensureMarks(T),w?!0:l.clearNodes()}).wrapInList(f,r).command(()=>ut(o,f)).command(()=>dt(o,f)).run()},ur=(e,t={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=D(e,r.schema);return gt(r,i,t)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,t)},dr=(e,t,n={})=>({state:r,commands:s})=>{const o=x(e,r.schema),i=x(t,r.schema),c=q(r,o,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),c?s.setNode(i,a):s.setNode(o,{...a,...n})},pr=(e,t={})=>({state:n,commands:r})=>{const s=x(e,n.schema);return q(n,s,t)?r.lift(s):r.wrapIn(s,t)},fr=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){const i=e.tr,c=o.transform;for(let a=c.steps.length-1;a>=0;a-=1)i.step(c.steps[a].invert(c.docs[a]));if(o.text){const a=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,a))}else i.delete(o.from,o.to)}return!0}}return!1},hr=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:s}=n;return r||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},mr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:c}=n,a=D(e,r.schema),{$from:l,empty:d,ranges:u}=c;if(!s)return!0;if(d&&i){let{from:p,to:f}=c;const h=(o=l.marks().find(g=>g.type===a))===null||o===void 0?void 0:o.attrs,m=St(l,a,h);m&&(p=m.from,f=m.to),n.removeMark(p,f,a)}else u.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,a)});return n.removeStoredMark(a),!0},gr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const c=at(typeof e=="string"?e:e.name,r.schema);return c?(c==="node"&&(o=x(e,r.schema)),c==="mark"&&(i=D(e,r.schema)),s&&n.selection.ranges.forEach(a=>{const l=a.$from.pos,d=a.$to.pos;let u,p,f,h;n.selection.empty?r.doc.nodesBetween(l,d,(m,g)=>{o&&o===m.type&&(f=Math.max(g,l),h=Math.min(g+m.nodeSize,d),u=g,p=m)}):r.doc.nodesBetween(l,d,(m,g)=>{g<l&&o&&o===m.type&&(f=Math.max(g,l),h=Math.min(g+m.nodeSize,d),u=g,p=m),g>=l&&g<=d&&(o&&o===m.type&&n.setNodeMarkup(g,void 0,{...m.attrs,...t}),i&&m.marks.length&&m.marks.forEach(y=>{if(i===y.type){const v=Math.max(g,l),M=Math.min(g+m.nodeSize,d);n.addMark(v,M,i.create({...y.attrs,...t}))}}))}),p&&(u!==void 0&&n.setNodeMarkup(u,void 0,{...p.attrs,...t}),i&&p.marks.length&&p.marks.forEach(m=>{i===m.type&&n.addMark(f,h,i.create({...m.attrs,...t}))}))}),!0):!1},yr=(e,t={})=>({state:n,dispatch:r})=>{const s=x(e,n.schema);return me(s,t)(n,r)},br=(e,t={})=>({state:n,dispatch:r})=>{const s=x(e,n.schema);return Le(s,t)(n,r)};var vr=Object.freeze({__proto__:null,blur:rn,clearContent:sn,clearNodes:on,command:an,createParagraphNear:cn,cut:ln,deleteCurrentNode:un,deleteNode:dn,deleteRange:pn,deleteSelection:fn,enter:hn,exitCode:mn,extendMarkRange:gn,first:yn,focus:bn,forEach:vn,insertContent:kn,insertContentAt:wn,joinBackward:Tn,joinDown:xn,joinForward:Cn,joinItemBackward:An,joinItemForward:On,joinTextblockBackward:Pn,joinTextblockForward:In,joinUp:En,keyboardShortcut:Ln,lift:Rn,liftEmptyBlock:Nn,liftListItem:Bn,newlineInCode:_n,resetAttributes:Dn,scrollIntoView:jn,selectAll:Hn,selectNodeBackward:Fn,selectNodeForward:zn,selectParentNode:Vn,selectTextblockEnd:Wn,selectTextblockStart:qn,setContent:Kn,setMark:er,setMeta:nr,setNode:rr,setNodeSelection:sr,setTextSelection:or,sinkListItem:ir,splitBlock:ar,splitListItem:cr,toggleList:lr,toggleMark:ur,toggleNode:dr,toggleWrap:pr,undoInputRule:fr,unsetAllMarks:hr,unsetMark:mr,updateAttributes:gr,wrapIn:yr,wrapInList:br});const kr=O.create({name:"commands",addCommands(){return{...vr}}}),Mr=O.create({name:"drop",addProseMirrorPlugins(){return[new R({key:new _("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),Sr=O.create({name:"editable",addProseMirrorPlugins(){return[new R({key:new _("editable"),props:{editable:()=>this.editor.options.editable}})]}}),wr=O.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new R({key:new _("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Er=O.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:c})=>{const{selection:a,doc:l}=c,{empty:d,$anchor:u}=a,{pos:p,parent:f}=u,h=u.parent.isTextblock&&p>0?c.doc.resolve(p-1):u,m=h.parent.type.spec.isolating,g=u.pos-u.parentOffset,y=m&&h.parent.childCount===1?g===u.pos:F.atStart(l).from===p;return!d||!f.type.isTextblock||f.textContent.length||!y||y&&u.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Yt()||Qt()?o:s},addProseMirrorPlugins(){return[new R({key:new _("clearDocument"),appendTransaction:(e,t,n)=>{const r=e.some(m=>m.docChanged)&&!t.doc.eq(n.doc),s=e.some(m=>m.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:c}=t.selection,a=F.atStart(t.doc).from,l=F.atEnd(t.doc).to;if(o||!(i===a&&c===l)||!Et(n.doc))return;const p=n.tr,f=nt({state:n,transaction:p}),{commands:h}=new rt({editor:this.editor,state:f});if(h.clearNodes(),!!p.steps.length)return p}})]}}),xr=O.create({name:"paste",addProseMirrorPlugins(){return[new R({key:new _("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),Tr=O.create({name:"tabindex",addProseMirrorPlugins(){return[new R({key:new _("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class j{get name(){return this.node.type.name}constructor(t,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new j(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new j(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new j(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1),c=this.resolvedPos.doc.resolve(i);if(!s&&c.depth<=this.depth)return;const a=new j(c,this.editor,s,s?n:null);s&&(a.actualDepth=this.depth+1),t.push(new j(c,this.editor,s,s?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let c=0;c<i.length;c+=1){const a=i[c];if(o[a]!==n[a])break}}else r=s;s=s.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===t&&o.every(a=>n[a]===i.node.attrs[a])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,n,r))))}),s}setAttribute(t){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(n)}}const Cr=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Ar(e,t,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}class Or extends Fe{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:s})=>this.options.onDrop(n,r,s)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Ar(Cr,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=Vt(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(t){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(t).forEach(o=>{const i=typeof o=="string"?`${o}$`:o.key;r=n.filter(c=>!c.key.startsWith(i))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var t,n;const s=[...this.options.enableCoreExtensions?[Sr,nn.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),kr,wr,Er,Tr,Mr,xr].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new z(s,this)}createCommandManager(){this.commandManager=new rt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let n;try{n=mt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(c=>c.name!=="collaboration"),this.createExtensionManager()}}),n=mt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Gt(n,this.options.autofocus);this.view=new ie(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(t=this.options.editorProps)===null||t===void 0?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:oe.create({doc:n,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(i=>{var c;return(c=this.capturedTransaction)===null||c===void 0?void 0:c.step(i)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=t.getMeta("focus"),o=t.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Qn(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,s=typeof t=="string"?n:t;return Xn(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return kt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return Jn(this.state.doc,{blockSeparator:n,textSerializers:{...qt(this.schema),...r}})}get isEmpty(){return Et(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new j(n,this)}get $doc(){return this.$pos(0)}}function V(e){return new ot({find:e.find,handler:({state:t,range:n,match:r})=>{const s=k(e.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=t,i=r[r.length-1],c=r[0];if(i){const a=c.search(/\S/),l=n.from+c.indexOf(i),d=l+i.length;if(Zt(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(m=>m===e.type&&m!==f.mark.type)).filter(f=>f.to>l).length)return null;d<n.to&&o.delete(d,n.to),l>n.from&&o.delete(n.from+a,l);const p=n.from+a+i.length;o.addMark(n.from+a,p,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function Pr(e){return new ot({find:e.find,handler:({state:t,range:n,match:r})=>{const s=k(e.getAttributes,void 0,r)||{},{tr:o}=t,i=n.from;let c=n.to;const a=e.type.create(s);if(r[1]){const l=r[0].lastIndexOf(r[1]);let d=i+l;d>c?d=c:c=d+r[1].length;const u=r[0][r[0].length-1];o.insertText(u,i+r[0].length-1),o.replaceWith(d,c,a)}else if(r[0]){const l=e.type.isInline?i:i-1;o.insert(l,e.type.create(s)).delete(o.mapping.map(i),o.mapping.map(c))}o.scrollIntoView()}})}function yt(e){return new ot({find:e.find,handler:({state:t,range:n,match:r})=>{const s=t.doc.resolve(n.from),o=k(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function K(e){return new ot({find:e.find,handler:({state:t,range:n,match:r,chain:s})=>{const o=k(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),a=i.doc.resolve(n.from).blockRange(),l=a&&de(a,e.type,o);if(!l)return null;if(i.wrap(a,l),e.keepMarks&&e.editor){const{selection:u,storedMarks:p}=t,{splittableMarks:f}=e.editor.extensionManager,h=p||u.$to.parentOffset&&u.$from.marks();if(h){const m=h.filter(g=>f.includes(g.type.name));i.ensureMarks(m)}}if(e.keepAttributes){const u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(u,o).run()}const d=i.doc.resolve(n.from-1).nodeBefore;d&&d.type===e.type&&vt(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,d))&&i.join(n.from-1)}})}class I{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(b(this,"addOptions",{name:this.name}))),this.storage=k(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new I(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>it(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new I(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(b(n,"addOptions",{name:n.name})),n.storage=k(b(n,"addStorage",{name:n.name,options:n.options})),n}}function W(e){return new Ye({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:s})=>{const o=k(e.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=t,c=r[r.length-1],a=r[0];let l=n.to;if(c){const d=a.search(/\S/),u=n.from+a.indexOf(c),p=u+c.length;if(Zt(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>u).length)return null;p<n.to&&i.delete(p,n.to),u>n.from&&i.delete(n.from+d,u),l=n.from+d+c.length,i.addMark(n.from+d,l,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function Ir(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var te={exports:{}},pt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rt;function $r(){if(Rt)return pt;Rt=1;var e=C;function t(u,p){return u===p&&(u!==0||1/u===1/p)||u!==u&&p!==p}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function c(u,p){var f=p(),h=r({inst:{value:f,getSnapshot:p}}),m=h[0].inst,g=h[1];return o(function(){m.value=f,m.getSnapshot=p,a(m)&&g({inst:m})},[u,f,p]),s(function(){return a(m)&&g({inst:m}),u(function(){a(m)&&g({inst:m})})},[u]),i(f),f}function a(u){var p=u.getSnapshot;u=u.value;try{var f=p();return!n(u,f)}catch{return!0}}function l(u,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:c;return pt.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,pt}te.exports=$r();var xt=te.exports;const Lr=(...e)=>t=>{e.forEach(n=>{typeof n=="function"?n(t):n&&(n.current=t)})},Rr=({contentComponent:e})=>{const t=xt.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return C.createElement(C.Fragment,null,Object.values(t))};function Nr(){const e=new Set;let t={};return{subscribe(n){return e.add(n),()=>{e.delete(n)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(n,r){t={...t,[n]:re.createPortal(r.reactElement,r.element,n)},e.forEach(s=>s())},removeRenderer(n){const r={...t};delete r[n],t=r,e.forEach(s=>s())}}}class Br extends C.Component{constructor(t){var n;super(t),this.editorContentRef=C.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=t.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.options.element.childNodes),t.setOptions({element:n}),t.contentComponent=Nr(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const t=this.props.editor;if(!t||(this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null,!t.options.element.firstChild))return;const n=document.createElement("div");n.append(...t.options.element.childNodes),t.setOptions({element:n})}render(){const{editor:t,innerRef:n,...r}=this.props;return C.createElement(C.Fragment,null,C.createElement("div",{ref:Lr(n,this.editorContentRef),...r}),(t==null?void 0:t.contentComponent)&&C.createElement(Rr,{contentComponent:t.contentComponent}))}}const _r=L.forwardRef((e,t)=>{const n=C.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return C.createElement(Br,{key:n,innerRef:t,...e})}),Ws=C.memo(_r);var Dr=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,s,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;for(s of t.entries())if(!e(s[1],n.get(s[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(t[s]!==n[s])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[s]))return!1;for(s=r;s--!==0;){var i=o[s];if(!(i==="_owner"&&t.$$typeof)&&!e(t[i],n[i]))return!1}return!0}return t!==t&&n!==n},jr=Ir(Dr),ee={exports:{}},ft={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nt;function Hr(){if(Nt)return ft;Nt=1;var e=C,t=xt;function n(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,c=e.useMemo,a=e.useDebugValue;return ft.useSyncExternalStoreWithSelector=function(l,d,u,p,f){var h=o(null);if(h.current===null){var m={hasValue:!1,value:null};h.current=m}else m=h.current;h=c(function(){function y(w){if(!v){if(v=!0,M=w,w=p(w),f!==void 0&&m.hasValue){var T=m.value;if(f(T,w))return E=T}return E=w}if(T=E,r(M,w))return T;var $=p(w);return f!==void 0&&f(T,$)?T:(M=w,E=$)}var v=!1,M,E,S=u===void 0?null:u;return[function(){return y(d())},S===null?void 0:function(){return y(S())}]},[d,u,p,f]);var g=s(l,h[0],h[1]);return i(function(){m.hasValue=!0,m.value=g},[g]),a(g),g},ft}ee.exports=Hr();var Fr=ee.exports;const zr=typeof window<"u"?L.useLayoutEffect:L.useEffect;class Vr{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function Wr(e){var t;const[n]=L.useState(()=>new Vr(e.editor)),r=Fr.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,(t=e.equalityFn)!==null&&t!==void 0?t:jr);return zr(()=>n.watch(e.editor),[e.editor,n]),L.useDebugValue(r),r}const qr=!1,bt=typeof window>"u",Kr=bt||!!(typeof window<"u"&&window.next);class Ur{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return bt||Kr?null:this.createEditor();if(this.options.current.immediatelyRender&&bt&&qr)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const t={...this.options.current,onBeforeCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(s,...r)},onBlur:(...r)=>{var s,o;return(o=(s=this.options.current).onBlur)===null||o===void 0?void 0:o.call(s,...r)},onCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onCreate)===null||o===void 0?void 0:o.call(s,...r)},onDestroy:(...r)=>{var s,o;return(o=(s=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(s,...r)},onFocus:(...r)=>{var s,o;return(o=(s=this.options.current).onFocus)===null||o===void 0?void 0:o.call(s,...r)},onSelectionUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(s,...r)},onTransaction:(...r)=>{var s,o;return(o=(s=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(s,...r)},onUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(s,...r)},onContentError:(...r)=>{var s,o;return(o=(s=this.options.current).onContentError)===null||o===void 0?void 0:o.call(s,...r)},onDrop:(...r)=>{var s,o;return(o=(s=this.options.current).onDrop)===null||o===void 0?void 0:o.call(s,...r)},onPaste:(...r)=>{var s,o;return(o=(s=this.options.current).onPaste)===null||o===void 0?void 0:o.call(s,...r)}};return new Or(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((r,s)=>r===t[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===t&&this.setEditor(null))},1)}}function qs(e={},t=[]){const n=L.useRef(e);n.current=e;const[r]=L.useState(()=>new Ur(n)),s=xt.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return L.useDebugValue(s),L.useEffect(r.onRender(t)),Wr({editor:s,selector:({transactionNumber:o})=>e.shouldRerenderOnTransaction===!1?null:e.immediatelyRender&&o===0?0:o+1}),s}const Gr=L.createContext({editor:null});Gr.Consumer;const Jr=L.createContext({onDragStart:void 0}),Yr=()=>L.useContext(Jr);C.forwardRef((e,t)=>{const{onDragStart:n}=Yr(),r=e.as||"div";return C.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});const Qr=/^\s*>\s$/,Xr=I.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[K({find:Qr,type:this.type})]}}),Zr=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,ts=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,es=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ns=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,rs=B.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[V({find:Zr,type:this.type}),V({find:es,type:this.type})]},addPasteRules(){return[W({find:ts,type:this.type}),W({find:ns,type:this.type})]}}),ss="listItem",Bt="textStyle",_t=/^\s*([-+*])\s$/,os=I.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",A(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ss,this.editor.getAttributes(Bt)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=K({find:_t,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=K({find:_t,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Bt),editor:this.editor})),[e]}}),is=/(^|[^`])`([^`]+)`(?!`)/,as=/(^|[^`])`([^`]+)`(?!`)/g,cs=B.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[V({find:is,type:this.type})]},addPasteRules(){return[W({find:as,type:this.type})]}}),ls=/^```([a-z]+)?[\s\n]$/,us=/^~~~([a-z]+)?[\s\n]$/,ds=I.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",A(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const c=s.after();return c===void 0?!1:r.nodeAt(c)?e.commands.command(({tr:l})=>(l.setSelection(F.near(r.resolve(c))),!0)):e.commands.exitCode()}}},addInputRules(){return[yt({find:ls,type:this.type,getAttributes:e=>({language:e[1]})}),yt({find:us,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new R({key:new _("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i,schema:c}=e.state,a=c.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},a)),i.selection.$from.parent.type!==this.type&&i.setSelection(P.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),ps=I.create({name:"doc",topNode:!0,content:"block+"}),fs=O.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Be(this.options)]}}),hs=O.create({name:"gapCursor",addProseMirrorPlugins(){return[_e()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=k(b(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),ms=I.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",A(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:c}=r.extensionManager,a=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:l,dispatch:d})=>{if(d&&a&&i){const u=a.filter(p=>c.includes(p.type.name));l.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),gs=I.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,A(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>yt({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),ys=O.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>He(e,t),redo:()=>({state:e,dispatch:t})=>je(e,t)}},addProseMirrorPlugins(){return[De(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),bs=I.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",A(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:r,$to:s}=n,o=e();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):Zn(n)?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:c})=>{var a;if(c){const{$to:l}=i.selection,d=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?i.setSelection(P.create(i.doc,l.pos+1)):l.nodeAfter.isBlock?i.setSelection(et.create(i.doc,l.pos)):i.setSelection(P.create(i.doc,l.pos));else{const u=(a=l.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();u&&(i.insert(d,u),i.setSelection(P.create(i.doc,d+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Pr({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),vs=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,ks=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ms=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Ss=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,ws=B.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[V({find:vs,type:this.type}),V({find:Ms,type:this.type})]},addPasteRules(){return[W({find:ks,type:this.type}),W({find:Ss,type:this.type})]}}),Es=I.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",A(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),xs="listItem",Dt="textStyle",jt=/^(\d+)\.\s$/,Ts=I.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",A(this.options.HTMLAttributes,n),0]:["ol",A(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(xs,this.editor.getAttributes(Dt)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=K({find:jt,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=K({find:jt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Dt)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),Cs=I.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),As=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Os=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Ps=B.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",A(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[V({find:As,type:this.type})]},addPasteRules(){return[W({find:Os,type:this.type})]}}),Is=I.create({name:"text",group:"inline"}),Ks=O.create({name:"starterKit",addExtensions(){var e,t,n,r,s,o,i,c,a,l,d,u,p,f,h,m,g,y;const v=[];return this.options.bold!==!1&&v.push(rs.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.blockquote!==!1&&v.push(Xr.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bulletList!==!1&&v.push(os.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&v.push(cs.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&v.push(ds.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&v.push(ps.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&v.push(fs.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&v.push(hs.configure((c=this.options)===null||c===void 0?void 0:c.gapcursor)),this.options.hardBreak!==!1&&v.push(ms.configure((a=this.options)===null||a===void 0?void 0:a.hardBreak)),this.options.heading!==!1&&v.push(gs.configure((l=this.options)===null||l===void 0?void 0:l.heading)),this.options.history!==!1&&v.push(ys.configure((d=this.options)===null||d===void 0?void 0:d.history)),this.options.horizontalRule!==!1&&v.push(bs.configure((u=this.options)===null||u===void 0?void 0:u.horizontalRule)),this.options.italic!==!1&&v.push(ws.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&v.push(Es.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&v.push(Ts.configure((h=this.options)===null||h===void 0?void 0:h.orderedList)),this.options.paragraph!==!1&&v.push(Cs.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&v.push(Ps.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&v.push(Is.configure((y=this.options)===null||y===void 0?void 0:y.text)),v}});export{Ws as E,Ks as S,qs as u};
