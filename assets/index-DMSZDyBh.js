import{j as e,r as i}from"./react-BWH9k979.js";import{c as N}from"./react-dom-BIt8mBlf.js";import{c as S,O as R,a as x,L as C,b as I,R as O}from"./@tanstack-DnyBfCVl.js";import{c as A}from"./@supabase-Blu4c-YX.js";import{u as P,S as F,E as L}from"./@tiptap-CCp1KiZO.js";import{f as w,s as T,e as M}from"./date-fns-Hw7GKizL.js";import"./scheduler-CzFDRTuY.js";import"./tiny-invariant-CopsF_GD.js";import"./tiny-warning-Dirz_SfZ.js";import"./use-sync-external-store-y5_7iTFR.js";import"./prosemirror-state-B7ijfdbY.js";import"./prosemirror-model-m3iZ3_G7.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-transform-OighmD1Q.js";import"./prosemirror-view-BZyUYLem.js";import"./prosemirror-keymap-cK5tcrkv.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-commands-8d75fuzH.js";import"./prosemirror-schema-list-7yJCSF5_.js";import"./prosemirror-dropcursor-JBYQTbem.js";import"./prosemirror-gapcursor-CVaYHaQC.js";import"./prosemirror-history-GfyDCu1z.js";import"./rope-sequence-Cxv9J64N.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function c(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(t){if(t.ep)return;t.ep=!0;const o=c(t);fetch(t.href,o)}})();const f=S({component:Y});function Y(){return e.jsx(i.Fragment,{children:e.jsx(R,{})})}const D="https://hzixifyflofyjudumvze.supabase.co",J="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh6aXhpZnlmbG9meWp1ZHVtdnplIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3NjYwNzYsImV4cCI6MjA1MTM0MjA3Nn0.ya997OdBn0jcwRtEDFZ0by-1XX5Q7iJSpFYml8wRAIM",d=A(D,J),U=x("/signup")({component:W});function W(){const[n,a]=i.useState(""),[c,l]=i.useState(""),[t,o]=i.useState(null),s=async r=>{r.preventDefault();const{error:m}=await d.auth.signUp({email:n,password:c});m?o(m.message):alert("Signup successful!")};return e.jsxs("div",{children:[e.jsx("h1",{children:"Sign Up"}),e.jsx("p",{children:"Join us and start your daily mental detox."}),e.jsxs("form",{onSubmit:s,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:n,onChange:r=>a(r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:c,onChange:r=>l(r.target.value),required:!0})]}),t&&e.jsx("p",{children:t}),e.jsx("button",{type:"submit",children:"Sign Up"})]})]})}const z=n=>n>=750?"text-green-500":n>=500?"text-yellow-500":"text-pink",_={session:null,isAuthenticated:!1,signIn:async()=>{console.warn("No AuthProvider available")},signOut:async()=>{console.warn("No AuthProvider available")}},b=i.createContext(_),q=({children:n})=>{const[a,c]=i.useState(null),l=!!a;i.useEffect(()=>{(async()=>{try{const{data:{session:s}}=await d.auth.getSession();c(s);const{data:{subscription:r}}=d.auth.onAuthStateChange((m,p)=>{c(p)});return()=>r.unsubscribe()}catch(s){console.error("Error initializing session:",s)}})()},[]);const t=async()=>{try{const{error:s}=await d.auth.signInWithOAuth({provider:"google"});s&&console.error("Error signing in:",s)}catch(s){console.error("Unexpected error during sign-in:",s)}},o=async()=>{try{const{error:s}=await d.auth.signOut();s&&console.error("Error signing out:",s)}catch(s){console.error("Unexpected error during sign-out:",s)}};return e.jsx(b.Provider,{value:{session:a,isAuthenticated:l,signIn:t,signOut:o},children:n})},v=()=>{const n=i.useContext(b);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},$=w(T(new Date)),X=w(M(new Date)),Z=()=>{const{session:n}=v(),[a,c]=i.useState(null),[l,t]=i.useState(!1),[o,s]=i.useState(0),r=P({extensions:[F],content:"",autofocus:!0,parseOptions:{preserveWhitespace:"full"},onUpdate:({editor:p})=>{const u=p.getHTML();s(p.getText().split(" ").filter(Boolean).length),m(u)}});i.useEffect(()=>{(async()=>{if(n!=null&&n.user)try{const{data:u,error:h}=await d.from("entries").select("*").eq("user_id",n.user.id).gte("created_at",$).lt("created_at",X),g=u==null?void 0:u[0];if(g){c(g.id),r==null||r.commands.setContent(g.content);const E=(r==null?void 0:r.getText())||"";s(E.split(" ").filter(Boolean).length);return}h&&console.error("Error fetching today's entry:",h);const{data:y,error:j}=await d.from("entries").insert([{user_id:n.user.id,content:""}]).single();j&&console.error("Error creating new entry:",j),y&&(c(y.id),r==null||r.commands.setContent(y.content))}catch(u){console.error("Error fetching or creating entry:",u)}})()},[r,n]);const m=async p=>{if(!a)return;t(!0);const u={content:p,word_count:o},{error:h}=await d.from("entries").update(u).eq("id",a);h&&console.error("Error saving entry:",h),t(!1)};return e.jsxs("div",{className:"w-full max-w-3xl mx-auto mt-10 h-full flex flex-col",children:[e.jsx("h1",{className:"font-bold text-pink mt-0 text-base",children:"Type 750: Your Mental Space"}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(L,{editor:r,className:"prose prose-lg b-none rounded custom-editor-content m-none font-weight-700 w-full"})}),e.jsxs("div",{className:"flex justify-between items-center font-bold mt-auto",children:[e.jsxs("p",{className:`text-sm text-gray-500 ${z(o)}`,children:["Word Count: ",o]}),e.jsx("p",{className:"text-sm text-gray-500",children:l?"Saving your thoughts...":"Thoughts saved"})]})]})},k=()=>{const{isAuthenticated:n}=v();return n?e.jsx("div",{className:"min-h-screen p-8 h-full flex flex-col",children:e.jsx(Z,{})}):e.jsx("div",{children:"You need to be authenticated to view this page."})},B=x("/new")({component:k}),K=x("/login")({component:V});function V(){const[n,a]=i.useState(""),[c,l]=i.useState(""),[t,o]=i.useState(null),s=async r=>{r.preventDefault();const{error:m}=await d.auth.signInWithPassword({email:n,password:c});o(m?m.message:null)};return e.jsxs("div",{className:"container",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Login"}),e.jsx("p",{className:"mb-6",children:"Log in to continue your journey of mental clarity."}),e.jsxs("form",{onSubmit:s,className:"max-w-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:n,onChange:r=>a(r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:c,onChange:r=>l(r.target.value),required:!0})]}),t&&e.jsx("div",{style:{color:"red"},children:t}),e.jsx("button",{type:"submit",children:"Login"})]})]})}const G=x("/")({component:H});function H(){return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center",children:[e.jsxs("header",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-pink",children:"Welcome to Type 750"}),e.jsx("p",{className:"text-lg text-gray-700 mt-4",children:"Your daily mental relief. Write 750 words every day to clear your mind and find peace."})]}),e.jsx("main",{className:"flex flex-col items-center",children:e.jsx(C,{to:"/new",className:"bg-pink text-white px-6 py-3 rounded-full text-lg mb-4",children:"Start Your Mental Detox"})}),e.jsx("footer",{className:"mt-8 text-gray-500",children:e.jsxs("p",{children:["Â© ",new Date().getFullYear()," Type 750. All rights reserved."]})})]})}const Q=U.update({id:"/signup",path:"/signup",getParentRoute:()=>f}),ee=B.update({id:"/new",path:"/new",getParentRoute:()=>f}),te=K.update({id:"/login",path:"/login",getParentRoute:()=>f}),re=G.update({id:"/",path:"/",getParentRoute:()=>f}),se={IndexRoute:re,LoginRoute:te,NewRoute:ee,SignupRoute:Q},ne=f._addFileChildren(se)._addFileTypes(),oe=I({routeTree:ne,basepath:"/type750"});function ie(){return e.jsx(q,{children:e.jsx(O,{router:oe})})}const ae=document.getElementById("root");N.createRoot(ae).render(e.jsx(i.StrictMode,{children:e.jsx(ie,{})}));
